<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Take pity</title>
	<meta name="author" content="Liksu">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="main.css">
</head>
<body>

<p id="phrase">&nbsp;</p>
<p class="button_holder">
	<button id="button" onclick="takePity(this)">Take pity</button>
</p>

<img src="" id="bear">

<script>
	/* config */

	var sex = 'male';

	var text = {
		en: {
			button: 'Complain',
			answers: {
				female: ['You my sweet bunny'],
				male: ['All will be good, bro']
			}
		},
		uk: {
			button: 'Пожалітися',
			answers: {
				female: [
					'Ти ж моє бідолашне зайченя'
				],
				male: []
			}
		},
		ru: {
			button: 'Пожаловаться',
			answers: {
				female: [
					  'Ах ты моя бедненькая'
					, 'Ты мой бедный зайчик!'
				],
				male: [
					  'Всё будет хорошо'
					, 'Переживешь!'
				]
			}
		}
	};

	var bears = {
		male: [{
			url: '/images/beer/beer_mug.png',
			style: {left: '32px', bottom: '16px'}
		}],
		female: [{
			url: '/images/bears/with_heart.png',
			style: {left: '16px'}
		}]
	};

	/* main */

	var language = navigator.languages ? navigator.languages[0] : (navigator.language || navigator.userLanguage);
	language = language.split('-')[0];
	text = text[language] || text.en;

	$id('button').innerHTML = text.button;

	var phrase = $id('phrase');
	var bear = $id('bear');
	var currentBear;

	function takePity() {
		phrase.innerHTML = getRandom(text.answers[sex]);
		if (text.answers[sex].length == 1) hide('button');
		setBear();
	}

	document.body.className = sex;

	/* helpers */

	function $id(id) { return document.getElementById(id) }

	function getRandom(array) {
		return array[Math.random() * array.length | 0]
	}

	function hide(el) {
		if (typeof el === 'string') el = $id(el);
		el.style.display = 'none';
	}

	function show(el, display) {
		if (typeof el === 'string') el = $id(el);
		el.style.display = display || 'block';
	}

	function setStyle(el, style, clear) {
		for (var key in style)
			el.style[key] = clear ? '' : style[key];
	}

	/* functional helpers */

	function setBear() {
		if (currentBear) {
			if (bears[sex].length <= 1) return;
			setStyle(bear, currentBear.style, 'clear');
		}

		currentBear = getRandom(bears[sex]);
		if (!currentBear) return;

		bear.src = currentBear.url;
		bear.className = currentBear.class || '';
		setStyle(bear, currentBear.style);
	}
</script>

<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-75866163-1', 'auto');
	ga('send', 'pageview');
</script>
</body>
</html>